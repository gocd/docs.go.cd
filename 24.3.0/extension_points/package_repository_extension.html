<!DOCTYPE html>



<html>

<head>
  <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Package Repository Extension | GoCD User Documentation</title>

<meta name="description" content="Pipelines in GoCD can poll packages in repositories similar to how they poll version control systems."/>
<meta name="keywords" content="[gocd pipelines, build pipelines, jenkins, version control, linux systems package, package repository, rpm, xml configuration, value stream modeling]"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="canonical" href="https://docs.gocd.org/current/extension_points/package_repository_extension.html"/>
<script src="../javascripts/vendor/jquery-3.6.4.min.js" crossorigin="anonymous"></script>
<script type="text/javascript" src="../javascripts/vendor/lunr-2.3.9.min.js"></script>

<script type="text/javascript" src="../javascripts/search/search.js"></script>
<script type="text/javascript" src="../javascripts/navigation/navigation.js"></script>
<script src="../javascripts/_common-to-all-pages.js" type="text/javascript"></script>

<link href="../images/favicon.ico" rel="shortcut icon">

<link rel="stylesheet" href="../stylesheets/normalize.min.css"/>
<link rel="stylesheet" href="../stylesheets/website.css"/>

<link rel="stylesheet" href="../stylesheets/book.min.ac5a65903b18d3093416406608606b21fbe03e953e39276b6a84377495f3a79e.css"/>

  
</head>

<body data-rel-permalink="/extension_points/package_repository_extension.html">
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="main-container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<a href="https://www.gocd.org"> <img src="../svg/product_ui_logo_go.svg" class="icon" /></a>


    



<script>
    (function() {
        var menu = document.querySelector('aside.book-menu nav')
        addEventListener('beforeunload', function(event) {
            localStorage.setItem('menu.scrollTop', menu.scrollTop)
        });
    })();
    function loadFunction(){
        var menu = document.querySelector('aside.book-menu nav')
        var top = parseInt(localStorage.getItem('menu.scrollTop'));
        $(menu).animate({
            scrollTop: top
        }, 10)
    }
    $(document).ready = loadFunction();
</script>


<style>
  nav ul a[href$="\2f extension_points\2fpackage_repository_extension.html"] {
  color: #004ed0;
  }
</style>

<div class="search-input-container">
  <input id="search" type="text" placeholder="Type to search">
</div>
<ul>
  <li class="level1">
    <a href="https://www.gocd.org/"><b>Go to GoCD.org</b></a>
  </li>
</ul>
<hr>
<ul>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>Welcome</b></a>
    <ul>
      <li class="level2"><a href="../">Introduction</a></li>
      <li class="level2"><a href="../introduction/concepts_in_go.html">Concepts in GoCD</a></li>
      <li class="level2"><a href="../navigation/value_stream_map.html">Value Stream Map</a></li>
    </ul>
  </li>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>Installation</b></a>
    <ul>
      <li class="level2"><a href="../installation/">Installing GoCD</a></li>
      <li class="level2"><a href="../installation/system_requirements.html">System requirements</a></li>
      <li class="level2"><a href="../installation/installing_go_server.html">Installing GoCD Server</a>
        <ul>
          <li class="level3"><a href="../installation/install/server/linux.html">Linux</a></li>
          <li class="level3"><a href="../installation/install/server/windows.html">Windows</a></li>
          <li class="level3"><a href="../installation/install/server/osx.html">MacOS</a></li>
          <li class="level3"><a href="../installation/install/server/zip.html">Generic Zip</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../installation/installing_go_agent.html">Installing GoCD Agent</a>
        <ul>
          <li class="level3"><a href="../installation/install/agent/linux.html">Linux</a></li>
          <li class="level3"><a href="../installation/install/agent/windows.html">Windows</a></li>
          <li class="level3"><a href="../installation/install/agent/osx.html">MacOS</a></li>
          <li class="level3"><a href="../installation/install/agent/zip.html">Generic Zip</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../installation/configuring_database.html">Configuring GoCD Database</a></li>
        <ul>
          <li class="level3"><a href="../installation/configuring_database/h2.html">H2</a></li>
          <li class="level3"><a href="../installation/configuring_database/postgres.html">PostgreSQL</a></li>
          <li class="level3"><a href="../installation/configuring_database/mysql.html">MySQL</a></li>
          <li class="level3"><a href="../installation/configuring_database/connection-properties.html">Database Connection Properties</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../installation/upgrading_go.html">Upgrading GoCD</a></li>
      <ul>
        <li class="level3"><a href="../installation/upgrading_go/upgrade_to_gocd_20.5.0.html">Upgrading to GoCD 20.5.0 and higher</a></li>
      </ul>
      <li class="level2"><a href="../installation/configuring_server_details.html">Configuring Server Details</a></li>
      <li class="level2"><a href="../installation/configure-reverse-proxy.html">Configure a Reverse Proxy</a></li>
      <li class="level2"><a href="../installation/configure-agent-proxy.html">Configure an agent with proxy</a></li>
      <li class="level2"><a href="../installation/ssl_tls_config.html">Configuring SSL/TLS</a>
        <ul>
          <li class="level3"><a href="../installation/ssl_tls/end_to_end_transport_security.html">End to end transport security</a></li>
          <li class="level3"><a href="../installation/ssl_tls/configuring_hsts_header.html">Configuring HSTS Header</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../installation/performance_tuning.html">Performance Tuning</a></li>
      <li class="level2"><a href="../installation/hardware_specifications.html">Hardware Specifications</a></li>
    </ul>
  </li>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>Configuration</b></a>
    <ul>
      <li class="level2"><a href="../configuration/pipelines.html">Pipelines</a>
        <ul>
          <li class="level3"><a href="../configuration/quick_pipeline_setup.html">Add a New Pipeline</a></li>
          <li class="level3"><a href="../configuration/admin_add_material.html">Add Material to Existing Pipeline</a></li>
          <li class="level3"><a href="../configuration/admin_add_stage.html">Add Stage to Existing Pipeline</a></li>
          <li class="level3"><a href="../configuration/admin_add_job.html">Add Job to Existing Stage</a></li>
          <li class="level3"><a href="../configuration/admin_add_task.html">Add Task to Existing Job</a></li>
          <li class="level3"><a href="../configuration/pipeline_templates.html">Pipeline Templates</a></li>
          <li class="level3"><a href="../configuration/admin_use_parameters_in_configuration.html">Using parameters in Pipelines and Templates</a></li>
          <li class="level3"><a href="../configuration/pipeline_labeling.html">Pipeline Labeling</a></li>
          <li class="level3"><a href="../configuration/pipeline_scheduling.html">Pipeline Scheduling</a></li>
          <li class="level3"><a href="../configuration/dev_choose_when_stage_runs.html">Choose When a Stage Runs</a></li>
          <li class="level3"><a href="../configuration/admin_timer.html">Timer Trigger</a></li>
          <li class="level3"><a href="../configuration/admin_lock_pipelines.html">Lock a Pipeline</a></li>
          <li class="level3"><a href="../configuration/job_timeout.html">Job Timeout</a></li>
          <li class="level3"><a href="../configuration/deleting_pipelines.html">Deleting Pipelines</a></li>
          <li class="level3"><a href="../configuration/managing_dependencies.html">Managing Dependencies</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../configuration/managing_a_build_cloud.html">Managing Agents</a>
        <ul>
          <li class="level3"><a href="../configuration/elastic_agents.html">Elastic Agents</a></li>
          <li class="level3"><a href="../configuration/clone_existing_agents.html">Clone/Copy Existing Agents</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../configuration/managing_environments.html">Managing Environments</a></li>
      <li class="level2"><a href="../configuration/managing_users.html">Managing Users</a>
        <ul>
          <li class="level3"><a href="../configuration/dev_authentication.html">Authentication</a></li>
          <li class="level3"><a href="../configuration/access_tokens.html">Access Tokens</a></li>
          <li class="level3"><a href="../configuration/dev_authorization.html">Authorizing Users</a></li>
          <li class="level3"><a href="../configuration/delegating_group_administration.html">Delegating Group Administration</a></li>
          <li class="level3"><a href="../configuration/pipeline_group_admin_config.html">Pipeline Group Administration</a></li>
          <li class="level3"><a href="../configuration/policy_in_gocd.html">Policy in GoCD</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../configuration/secrets_management.html">Secrets Management</a>
      </li>
      <li class="level2">Artifacts
        <ul>
          <li class="level3"><a href="../configuration/dev_upload_test_report.html">Publish Reports and Artifacts</a></li>
          <li class="level3"><a href="../configuration/managing_artifacts_and_reports.html">Managing Artifacts and Reports</a></li>
          <li class="level3"><a href="../configuration/delete_artifacts.html">Auto Delete Artifacts</a></li>
        </ul>
      </li>
      <li class="level2"><a href="../configuration/admin_mailhost_info.html">Email server configuration</a></li>
      <li class="level2"><a href="../configuration/dev_notifications.html">Notifications</a></li>
      <li class="level2"><a href="../configuration/configuration_reference.html">Reference</a></li>
    </ul>
  </li>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>Advanced Usage</b></a>
    <ul>
      <li class="level2"><a href="../advanced_usage/pipelines_as_code.html">Pipelines as code</a></li>
      <li class="level2"><a href="../advanced_usage/agent_auto_register.html">Auto Register a Remote Agent</a></li>
      <li class="level2"><a href="../advanced_usage/admin_spawn_multiple_jobs.html">Spawn multiple instances of a Job</a></li>
      <li class="level2"><a href="../advanced_usage/admin_install_multiple_agents.html">Multiple Agents on One Machine</a></li>
      <li class="level2"><a href="../advanced_usage/dev_clean_up_when_cancel.html">Clean on Task Cancel</a></li>
      <li class="level2"><a href="../advanced_usage/dev_conditional_task_execution.html">Conditional Task Execution</a></li>
      <li class="level2"><a href="../advanced_usage/trigger_with_options.html">Trigger With Options</a></li>
      <li class="level2"><a href="../advanced_usage/fan_in.html">Fan In</a></li>
      <li class="level2"><a href="../advanced_usage/logging.html">Logging</a></li>
      <li class="level2"><a href="../advanced_usage/ui_testing.html">UI Testing</a></li>
      <li class="level2"><a href="../advanced_usage/compare_pipelines.html">Compare Builds</a></li>
      <li class="level2"><a href="../advanced_usage/stage_duration_chart.html">Graphs</a></li>
      <li class="level2"><a href="../advanced_usage/one_click_backup.html">Backup GoCD Server</a></li>
      <li class="level2"><a href="../advanced_usage/cron_backup.html">Timer Based GoCD Server Backup</a></li>
      <li class="level2"><a href="../advanced_usage/config_repo.html">Config Repository</a></li>
      <li class="level2"><a href="../advanced_usage/other_config_options.html">Other Config Options</a></li>
      <li class="level2"><a href="../advanced_usage/agent-health-check-api.html">Agent Health Check API</a></li>
      <li class="level2"><a href="../advanced_usage/maintenance_mode.html">Maintenance Mode</a></li>
      <li class="level2"><a href="../advanced_usage/pipeline_activity.html">Pipeline activity</a></li>
      <li class="level2"><a href="../integration/">Integrating GoCD With Other Tools</a></li>
    </ul>
  </li>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>GoCD on Kubernetes</b></a>
    <ul>
      <li class="level2"><a href="../gocd_on_kubernetes/introduction.html">Introduction</a></li>
      <li class="level2"><a href="../gocd_on_kubernetes/setup_and_configuration.html">Setup and configuration</a></li>
      <li class="level2"><a href="../gocd_on_kubernetes/helm_install.html">Install the GoCD Helm chart</a></li>
      <li class="level2"><a href="../gocd_on_kubernetes/importing_a_sample_workflow.html">Importing a sample workflow</a></li>
      <li class="level2"><a href="../gocd_on_kubernetes/sample_pipelines_explained.html">An explanation of the sample pipelines</a></li>
      <li class="level2"><a href="../gocd_on_kubernetes/docker_workflows.html">Docker workflows</a></li>
    </ul>
  </li>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>Plugins in GoCD</b></a>
    <ul>
      <li class="level2"><a href="../extension_points/">Available extension points</a></li>
      <li class="level2"><a href="../extension_points/plugin_user_guide.html">Plugin User Guide</a></li>
      <li class="level2"><a href="../extension_points/package_repository_extension.html">Package Repository Extension</a></li>
      <li class="level2"><a href="../extension_points/yum_repository_poller.html">Yum Repository Poller</a></li>
      <li class="level2"><a href="../extension_points/scm_extension.html">SCM Extension</a></li>
      <li class="level2"><a href="../extension_points/task_extension.html">Task Extension</a></li>
    </ul>
  </li>
  <li class="level1 has-children">
    <figure class="menu-arrow"><img src="../images/arrow.png"/>
    </figure>

    <a href="#"><b>FAQ/Troubleshooting</b></a>
    <ul>
      <li class="level2"><a href="../faq/fixing_common_issues.html">Fixing common issues</a></li>
      <li class="level2"><a href="../faq/artifact_integrity.html">Artifact integrity verification</a></li>
      <li class="level2"><a href="../faq/rm_what_is_deployed.html">Check What's Deployed</a></li>
      <li class="level2"><a href="../faq/concurrent_config_modifications.html">Concurrent Modifications to Config</a></li>
      <li class="level2"><a href="../faq/docker_container_ssh_keys.html">Configure SSH Keys for dockerized GoCD</a></li>
      <li class="level2"><a href="../faq/deploy_a_specific_build_to_an_environment.html">Deploy a Specific Build</a></li>
      <li class="level2"><a href="../faq/rm_deploy_to_environment.html">Deploy to an environment</a></li>
      <li class="level2"><a href="../faq/material_update_hung.html">GoCD unable to poll for changes</a></li>
      <li class="level2"><a href="../faq/stage_old_config.html">Historical Configuration</a></li>
      <li class="level2"><a href="../faq/job_rerun.html">How do I re-run jobs?</a></li>
      <li class="level2"><a href="../faq/ordering_of_pipelines.html">Ordering of Pipelines</a></li>
      <li class="level2"><a href="../faq/dependency_management.html">Run Tests against new Builds</a></li>
      <li class="level2"><a href="../faq/admin_out_of_disk_space.html">Running out of Disk Space</a></li>
      <li class="level2"><a href="../faq/dev_see_artifact_as_tab.html">See artifacts as sub-tabs</a></li>
      <li class="level2"><a href="../faq/tester_what_has_changed.html">See changes in new binary</a></li>
      <li class="level2"><a href="../faq/dev_use_current_revision_in_build.html">Using Environment variables</a></li>
      <li class="level2"><a href="../faq/dev_understand_why_build_broken.html">Why the Build is Broken?</a></li>
    </ul>
  </li>
</ul>




</nav>
    </aside>

    
    <div class="navigation-bar">
    <a href="#" class="navigation navigation-prev">
        <i class="fa fa-angle-left"></i> &lt; Previous Page
    </a>

    <a href="#" class="navigation navigation-next">
        <i class="fa fa-angle-right"></i> Next Page &gt;
    </a>
</div>

    <div class="book-page ">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="../svg/menu.svg" />
  </label>
  <strong>Package Repository Extension</strong>
</header>

      
<div class="has-results">
    <h1 id="searchResultTitle" class="search-results-title hide"></h1>
    <ul id="results"></ul>
</div>
<div class="no-results hide">
    Your query search resulted in no results.
</div>

      
<article class="markdown"><h1 id="gocd-package-material">GoCD Package Material</h1>
<h2 id="introduction">Introduction</h2>
<p>Poll from GoCD packages and more from GoCD 13.3 onwards.
Pipelines in GoCD can poll packages in repositories similar to how they poll version control systems. A build typically consumes source code maintained in a version control system (VCS/SCM). What about a typical deployment? Increasingly, the input for deployments is the build result packaged as:</p>
<ol>
<li>jar, war or ear file in case of Java</li>
<li><a href="https://nuget.org/">nuget</a>/ <a href="https://chocolatey.org/">chocolatey</a> package in case of .NET</li>
<li><a href="https://en.wikipedia.org/wiki/Package_management_system#Package_formats">Linux system package</a> (e.g rpm, deb) in case of any application platform</li>
<li>Other <a href="https://en.wikipedia.org/wiki/List_of_software_package_management_systems#Application-level_package_managers">application level package formats</a> like gem, npm, <a href="https://www.php.net/manual/en/book.phar.php">phar</a>, <a href="https://www.python.org/dev/peps/pep-0427/">wheel</a> etc.</li>
</ol>
<p>These files (packages) are often maintained in corresponding package repositories. <strong>Such packages may be specified as materials for GoCD pipelines.</strong></p>
<h3 id="supported-packages">Supported Packages</h3>
<p>Since there are many package formats each with its own package manager and repository, the support for package-as-material has been implemented as an extension point. Using the <a href="yum_repository_poller.html">yum-repo-poller plugin</a>, it is possible to specify an rpm package held in a yum repository as a material for a GoCD pipeline. Using other <a href="https://www.gocd.org/plugins/">external plugins</a>, it is possible to do the same for other types of packages.</p>
<h3 id="repositories-packages-and-materials">Repositories, Packages and Materials</h3>
<p>A repository may contain one or more packages. A pipeline may refer to a package as a material. When the package is updated in the repository, interested pipelines will get scheduled.</p>
<h4 id="repository-definition">Repository Definition</h4>
<p>A package material plugin lets pipeline group admins provide details of the corresponding repository type to GoCD. e.g. here is how we define a yum repository using the <a href="yum_repository_poller.html">yum-repo-poller plugin</a>.</p>
<h5 id="note">Note:</h5>
<ol>
<li>The repository name is not used by the package material plugin - it is used by Go to construct the material name.</li>
<li>Two package repositories cannot have the same name.</li>
<li>Use the check connection button to ensure that Go can work with this repository.</li>
</ol>
<p><img src="../images/yum-repo.png" alt=""></p>
<h4 id="package-definition">Package Definition</h4>
<p>A package material plugin also lets you define packages at the time of pipeline material configuration (Admin &gt; Material &gt;Add Material &gt; Package). Here is what it looks like for defining RPM packages with the Yum plugin. The package name is not used by the package material plugin - it is used by Go to construct the material name. Two packages in a repository cannot have the same name. Use the check package button to ensure that the package definition does indeed resolve to the package you are looking for.</p>
<p><img src="../images/yum-pkg.png" alt=""></p>
<p>Unlike other VCS/SCM materials, <em>the material definition in case of packages is not contained within the pipeline definition</em>. Many pipelines may have material definitions referring to the same package. Here is how we associate an existing package as material for a pipeline.</p>
<p><img src="../images/yum-pkg-exist.png" alt=""></p>
<h5 id="note-1">Note:</h5>
<p>Each package definition must resolve to exactly one package on the repository, else the pipeline will not run. In order to set up a pipeline that polls for multiple packages, configure each package as a separate material.</p>
<p>Each package material plugin defines a subset of its properties as a <em>package fingerprint</em>. e.g. in case of the Yum plugin this subset consists of Repository URL and Package Spec (it excludes repository username and password). Repository and Package names are <strong>not</strong> part of package fingerprint. It is not permitted to multiple packages having the same package fingerprint. An attempt to do so will result in an error message like this:</p>
<p>The following error(s) need to be resolved in order to perform this action:<br>
Cannot save package or repo, found duplicate packages. [Repo Name: &lsquo;orchard&rsquo;, Package Name: &lsquo;apple&rsquo;], [Repo Name: &lsquo;orchard&rsquo;, Package Name: &lsquo;orange&rsquo;]</p>
<h4 id="sample-xml-configuration">Sample XML Configuration</h4>
<p>Here is a XML view of an RPM package definition. Note the relation between repository, package and pipeline material. Loosely typed property, key and value tags are used for repository and package configuration in order to accommodate different plugins. If you choose to configure via direct XML edit, note that it isn&rsquo;t necessary to provide repository and package IDs, Go server will autogenerate them. However, not all validations that are performed while configuring via UI kick in while configuring via XML edit - the resulting failures will show up later in the server health message panel at the bottom right of the browser frame.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">&lt;repository</span> <span style="color:#b44">id=</span><span style="color:#b44">&#34;1ce5c205-977f-4c0e-ada4-882030580eed&#34;</span> <span style="color:#b44">name=</span><span style="color:#b44">&#34;ora&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000;font-weight:bold">&lt;pluginConfiguration</span> <span style="color:#b44">id=</span><span style="color:#b44">&#34;yum&#34;</span> <span style="color:#b44">version=</span><span style="color:#b44">&#34;1&#34;</span> <span style="color:#008000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000;font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000;font-weight:bold">&lt;key&gt;</span>REPO_URL<span style="color:#008000;font-weight:bold">&lt;/key&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000;font-weight:bold">&lt;value&gt;</span>http://public-yum.oracle.com/repo/OracleLinux/OL6/latest/x86_64<span style="color:#008000;font-weight:bold">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000;font-weight:bold">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000;font-weight:bold">&lt;packages&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;package</span> <span style="color:#b44">id=</span><span style="color:#b44">&#34;840b0b60-bd29-489d-b5ea-ccff5f6459a9&#34;</span> <span style="color:#b44">name=</span><span style="color:#b44">&#34;gcc&#34;</span> <span style="color:#b44">autoUpdate=</span><span style="color:#b44">&#34;false&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000;font-weight:bold">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">&lt;property&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#008000;font-weight:bold">&lt;key&gt;</span>PACKAGE_SPEC<span style="color:#008000;font-weight:bold">&lt;/key&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#008000;font-weight:bold">&lt;value&gt;</span>gcc-4.*<span style="color:#008000;font-weight:bold">&lt;/value&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000;font-weight:bold">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;/package&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000;font-weight:bold">&lt;/packages&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">&lt;/repository&gt;</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">&lt;pipelines</span> <span style="color:#b44">group=</span><span style="color:#b44">&#34;showcase&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#008000;font-weight:bold">&lt;pipeline</span> <span style="color:#b44">name=</span><span style="color:#b44">&#34;dependsOnGcc&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;materials&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#008000;font-weight:bold">&lt;package</span> <span style="color:#b44">ref=</span><span style="color:#b44">&#34;840b0b60-bd29-489d-b5ea-ccff5f6459a9&#34;</span> <span style="color:#008000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;/materials&gt;</span>
</span></span><span style="display:flex;"><span>  ...
</span></span></code></pre></div><h3 id="value-stream-modeling-tip">Value stream modeling tip</h3>
<p>Depending on whether GoCD is also publishing the package or just consuming it, there are two options for modeling a value stream that includes packages.</p>
<ol>
<li>
<p>The first scenario is where the package is published from some pipeline in GoCD. Say pipeline X publishes package P to an external repo and pipeline Y consumes P. To trigger Y after publication of P, there are two options:</p>
<ol>
<li>Pipeline dependency: X becomes a material for Y. Y resolves the exact version of P and downloads it on its own (although this <a href="https://groups.google.com/g/go-cd/c/uhvtmYfoRMs">tip</a> may be used to pass package version information from X to Y). X will appear as an upstream component of Y in the <a href="../navigation/value_stream_map.html">value stream map.</a></li>
<li>Package material: Y adds P as a package material. Y no longer has to resolve P.</li>
</ol>
<p>It isn&rsquo;t advisable to do both as Y will then schedule twice. The choice depends on how closely the activities in pipeline X and Y are related. If it is important to see X and Y together in the same value stream map, then option #1 makes sense.</p>
</li>
<li>
<p>The second scenario is where GoCD does not know about how/who published the package. Perhaps it got published by a job in Jenkins. Or perhaps the package is an open source package on a public repository on the internet. In this case the only option is to use a package material. GoCD helps you trace back to the external origin of the package if the package creator adds trackback information to the package metadata. The details of this will vary by plugin. In case of the Yum plugin, we use the URL field in rpm metadata for this.</p>
</li>
</ol>
<h3 id="permissions">Permissions</h3>
<p>Repositories and their packages are global entities not tied to a pipeline group or environment. Pipeline group admins may define repositories and packages for use in their pipelines. One pipeline group admin may also use packages defined by another for their pipelines. Changing a package definition will cause all dependent pipelines to schedule - even those not in the same pipeline group as that of the person editing. Because of this, we don&rsquo;t have a UI way of changing the definition of a package. Only the GoCD admin can change it via Admin &gt; Config XML tab.</p>
<h3 id="polling">Polling</h3>
<p>Even if no pipelines use a package, GoCD polls for newer packages every minute. This may be turned off at a package level by setting <a href="../configuration/configuration_reference.html#package">autoUpdate</a> to false via the config xml (GoCD admins only). autoUpdate is turned on by default. When a newer package is found, the pipelines for which it is a material get scheduled (assuming <a href="../configuration/pipeline_scheduling.html">auto scheduling of pipelines</a> is on). Also see <a href="https://api.gocd.org/current/#scheduling-pipelines">API scheduling</a>.</p>
<h3 id="package-information-display">Package information display</h3>
<p>The following information is expected from the package material plugin (which in turn obtains it from the package metadata if available)</p>
<ol>
<li>Package revision (e.g. gcc-4.4.7-3.el6.x86_64)</li>
<li>Package build time</li>
<li>Name of package creator (if available)</li>
<li>Package comment</li>
<li>Trackback URL - Typically an absolute URL that indicates what job (in GoCD or otherwise) created the package.</li>
<li>Package - material name (i.e. repo-name:package-name)</li>
</ol>
<p>At the time of building the package, it is recommended to include as much of the above information as possible so that it is available for Go to display as below.</p>
<p><img src="../images/package-changes.png" alt=""></p>
<h3 id="downloading-the-package">Downloading the package</h3>
<p>The package isn&rsquo;t automatically downloaded on the agent and made available to the jobs. This is unlike VCS/SCM materials where a checkout is made by default. In case of packages, the GoCD Agent is typically not the target node for deployment, it is only orchestrating deployment to a remote node. So, instead of an automatic download, the following environment variables are made available:</p>
<ol>
<li>GO_PACKAGE_&lt; REPO-NAME &gt;_&lt; PACKAGE-NAME &gt;_LABEL</li>
<li>GO_REPO_&lt; REPO-NAME &gt;_&lt; PACKAGE-NAME &gt;_REPO_URL</li>
<li>GO_PACKAGE_&lt; REPO-NAME &gt;_&lt; PACKAGE-NAME &gt;_LOCATION</li>
</ol>
<p>Repository and package names are converted to all uppercase and hyphens are converted to underscores before inclusion in the environment variable names. For example, let&rsquo;s say we set up a repository named ORA pointing to <a href="https://public-yum.oracle.com/repo/OracleLinux/OL6/latest/x86_64">https://public-yum.oracle.com/repo/OracleLinux/OL6/latest/x86_64</a> and define a package gcc with a spec of gcc-4.* and set it up as material for a pipeline. To download the package locally on the agent, we could write a task like this:</p>
<pre tabindex="0"><code>[go] Start to execute task: &lt;exec command=&#34;/bin/bash&#34; &gt;
&lt;arg&gt;-c&lt;/arg&gt;
&lt;arg&gt;curl -o /tmp/gcc.rpm $GO_PACKAGE_ORA_GCC_LOCATION&lt;/arg&gt;
&lt;/exec&gt;
</code></pre><p>When the task executes on the agent, the environment variables get subsituted as below:</p>
<pre tabindex="0"><code>[go] Start to execute task: &lt;exec command=&#34;/bin/bash&#34; &gt;
&lt;arg&gt;-c&lt;/arg&gt;
&lt;arg&gt;curl -o /tmp/gcc.rpm $GO_PACKAGE_ORA_GCC_LOCATION&lt;/arg&gt;
&lt;/exec&gt;.
...
[go] setting environment variable &#39;GO_PACKAGE_ORA_GCC_LABEL&#39; to value &#39;gcc-4.4.7-3.el6.x86_64&#39;
[go] setting environment variable &#39;GO_REPO_ORA_GCC_REPO_URL&#39; to value &#39;https://public-yum.oracle.com/repo/OracleLinux/OL6/latest/x86_64&#39;
[go] setting environment variable &#39;GO_PACKAGE_ORA_GCC_PACKAGE_SPEC&#39; to value &#39;gcc-4.*&#39;
[go] setting environment variable &#39;GO_PACKAGE_ORA_GCC_LOCATION&#39; to value &#39;https://public-yum.oracle.com/repo/OracleLinux/OL6/latest/x86_64/getPackage/gcc-4.4.7-3.el6.x86_64.rpm&#39;
...
</code></pre><p>Or, to simply pass it as an argument to a deploy script on a remote server</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">&lt;exec</span> <span style="color:#b44">command=</span><span style="color:#b44">&#34;/bin/bash&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;arg&gt;</span>-c<span style="color:#008000;font-weight:bold">&lt;/arg&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">&lt;arg&gt;</span>ssh server &#34;cd /to/dest/dir;deploy.sh $GO_PACKAGE_ORA_GCC_LOCATION&#34;<span style="color:#008000;font-weight:bold">&lt;/arg&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">&lt;/exec&gt;</span>
</span></span></code></pre></div><p><strong>Also see <a href="yum_repository_poller.html#installing-rpms">Installing RPMs</a></strong></p>
<blockquote>
<p><strong>Important:</strong> Please note that if you change repository credentials and then try to re-trigger (redeploy) an old package, the published environment variables will not reflect new credentials.</p>
</blockquote>
<h3 id="publishing-a-package">Publishing a Package</h3>
<p>At the moment, GoCD does not create or publish the package for you. But it is simple enough for each type of package. e.g. <a href="yum_repository_poller.html#creating-and-publishing-rpms">rpm</a></p>
<h3 id="package-dependencies">Package Dependencies</h3>
<p>Please note that GoCD does not support any sort of automatic polling or other support for package dependencies. Each package dependency has to specified as a separate material if needed. Alternatively, just poll for the packages at the root of the dependency graph and let the package manager figure out the rest at the time of installation. e.g. if componentA-1.2.0-b234-noarch.rpm depends on componentB-2.3.0 or above, simply poll for componentA and let</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install componentA-1.2.0-b234-noarch
</span></span></code></pre></div><p>do the resolution of componentB for you.</p>
</article>

      
<div class="align-center book-git-footer justify-between">
  

  
  <div>
    <a href="#" class="navigation navigation-prev">
      <i class="fa fa-angle-left"></i> &lt; Previous Page
    </a>
  </div>
  

  
  <div>
    <a id="suggest-edits" href="https://github.com/gocd/docs.go.cd/edit/master/content/extension_points/package_repository_extension.md" target="_blank" rel="noopener">
      <img src="../svg/code-fork.svg" /> Suggest edits to this page
    </a>
  </div>
  

  
  <div>
    <a href="#" class="navigation navigation-next">
      <i class="fa fa-angle-right"></i> Next Page &gt;
    </a>
  </div>
  

</div>


    </div>

    

  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a>
      <ul>
        <li><a href="#supported-packages">Supported Packages</a></li>
        <li><a href="#repositories-packages-and-materials">Repositories, Packages and Materials</a></li>
        <li><a href="#value-stream-modeling-tip">Value stream modeling tip</a></li>
        <li><a href="#permissions">Permissions</a></li>
        <li><a href="#polling">Polling</a></li>
        <li><a href="#package-information-display">Package information display</a></li>
        <li><a href="#downloading-the-package">Downloading the package</a></li>
        <li><a href="#publishing-a-package">Publishing a Package</a></li>
        <li><a href="#package-dependencies">Package Dependencies</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </aside>



  </main>

  
</body>

</html>
