<!DOCTYPE html>


<html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lock a Pipeline | GoCD User Documentation</title>

<meta name="description" content="Ensure only one instance of a GoCD pipeline can run at the same time"/>
<meta name="keywords" content="[GoCD congfiguration, continuous delivery pipeline, stage, locked pipeline, pipeline scheduling, pipeline locking]"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="canonical" href="https://docs.gocd.org/current/configuration/admin_lock_pipelines.html"/>
<script src="../javascripts/_gdpr-banner.js" type="text/javascript"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.5/lunr.min.js"></script>
<script type="text/javascript" src="../javascripts/search/search.js"></script>

<script src="../javascripts/_img-zoom.js" type="text/javascript"></script>
<link rel="stylesheet" href="../normalize.min.css"/>
<link rel="stylesheet" href="../stylesheets/website.css"/>

<link rel="stylesheet" href="../book.min.5e6fb59ed78af063451fd39b66f2736b1be0062aa7b2a03ff91aee7f959f808a.css"/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-48357651-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<a href="https://www.gocd.org"> <img src="../svg/product_ui_logo_go.svg" class="icon" /></a>


    



<script>
    (function() {
        var menu = document.querySelector('aside.book-menu nav')
        addEventListener('beforeunload', function(event) {
            localStorage.setItem('menu.scrollTop', menu.scrollTop)
        });
    })();
    function loadFunction(){
        var menu = document.querySelector('aside.book-menu nav')
        var top = parseInt(localStorage.getItem('menu.scrollTop'));
        $(menu).animate({
            scrollTop: top
        }, 10)
    }
    $(document).ready = loadFunction();
</script>


<style>
  nav ul a[href$="\2f configuration\2f admin_lock_pipelines.html"] {
  color: #004ed0;
  }
</style>

<div class="search-input-container">
  <input id="search" type="text" placeholder="Type to search">
</div>

<ul>
<li><a href="https://www.gocd.org/"><strong>Back to GoCD.org</strong></a></li>

<li><p><a href="https://github.com/gocd/docs.go.cd/"><strong>Contribute</strong></a></p>

<hr /></li>

<li><p><a href="../"><strong>Introduction</strong></a></p></li>

<li><p><a href="../introduction/"><strong>Concepts In GoCD</strong></a></p>

<ul>
<li><a href="../introduction/concepts_in_go.html">Concepts In GoCD</a></li>
</ul></li>

<li><p><a href="../navigation/"><strong>GoCD Tour</strong></a></p>

<ul>
<li><a href="../navigation/pipelines_dashboard_page.html">Pipeline Dashboard</a></li>
<li><a href="../navigation/agents_page.html">Agents</a></li>
<li><a href="../navigation/agent_details.html">Agent Details</a></li>
<li><a href="../navigation/pipeline_activity_page.html">Pipeline Activity</a></li>
<li><a href="../navigation/stage_details_page.html">Stage Details</a></li>
<li><a href="../navigation/job_details_page.html">Job Details</a></li>
<li><a href="../navigation/administration_page.html">Administration</a></li>
<li><a href="../navigation/server_details_page.html">Server Details</a></li>
<li><a href="../navigation/environments_page.html">Environments</a></li>
<li><a href="../navigation/value_stream_map.html">Value Stream Map</a></li>
</ul></li>

<li><p><a href="../installation/"><strong>Installing GoCD</strong></a></p>

<ul>
<li><a href="../installation/system_requirements.html">System requirements</a></li>
<li><a href="../installation/installing_go_server.html">Installing GoCD Server</a>

<ul>
<li><a href="../installation/install/server/linux.html">Linux</a></li>
<li><a href="../installation/install/server/windows.html">Windows</a></li>
<li><a href="../installation/install/server/osx.html">Mac OS X</a></li>
<li><a href="../installation/install/server/zip.html">Generic Zip</a></li>
</ul></li>
<li><a href="../installation/installing_go_agent.html">Installing GoCD Agent</a>

<ul>
<li><a href="../installation/install/agent/linux.html">Linux</a></li>
<li><a href="../installation/install/agent/windows.html">Windows</a></li>
<li><a href="../installation/install/agent/osx.html">Mac OS X</a></li>
<li><a href="../installation/install/agent/zip.html">Generic Zip</a></li>
</ul></li>
<li><a href="../installation/upgrading_go.html">Upgrading GoCD</a></li>
<li><a href="../installation/configuring_server_details.html">Configuring Server Details</a></li>
<li><a href="../installation/configure-reverse-proxy.html">Configure a Reverse Proxy</a></li>
<li><a href="../installation/configure-agent-proxy.html">Configure an agent with proxy</a></li>
<li><a href="../installation/ssl_tls_config.html">Configuring SSL/TLS</a>

<ul>
<li><a href="../installation/ssl_tls/setting_up_ciphers.html">Customizing Ciphers</a></li>
<li><a href="../installation/ssl_tls/custom_server_certificate.html">Change SSL Certificates</a></li>
<li><a href="../installation/ssl_tls/end_to_end_transport_security.html">End to end transport security</a></li>
<li><a href="../installation/ssl_tls/configuring_hsts_header.html">Configuring HSTS Header</a></li>
</ul></li>
<li><a href="../installation/performance_tuning.html">Performance Tuning</a></li>
<li><a href="../installation/hardware_specifications.html">Hardware Specifications</a></li>
<li><a href="../installation/troubleshooting.html">Troubleshooting</a></li>
</ul></li>

<li><p><a href="../configuration/"><strong>Configuration</strong></a></p>

<ul>
<li><a href="../configuration/quick_pipeline_setup.html">Setup a New Pipeline</a></li>
<li><a href="../configuration/managing_pipelines.html">Managing Pipelines</a></li>
<li><a href="../configuration/managing_dependencies.html">Managing Dependencies</a></li>
<li><a href="../configuration/managing_a_build_cloud.html">Managing Agents</a></li>
<li><a href="../configuration/managing_environments.html">Managing Environments</a></li>
<li><a href="../configuration/build_labelling.html">Pipeline Labelling</a></li>
<li><a href="../configuration/pipeline_scheduling.html">Pipeline Scheduling</a></li>
<li><a href="../configuration/admin_use_parameters_in_configuration.html">Parameterize a Pipeline</a></li>
<li><a href="../configuration/admin_use_custom_pipeline_label.html">Customize a Pipeline Label</a></li>
<li><a href="../configuration/admin_clone_pipeline.html">Clone a Pipeline</a></li>
<li><a href="../configuration/admin_lock_pipelines.html">Lock a Pipeline</a></li>
<li><a href="../configuration/admin_add_material.html">Add Material to Existing Pipeline</a></li>
<li><a href="../configuration/admin_add_stage.html">Add Stage to Existing Pipeline</a></li>
<li><a href="../configuration/admin_add_job.html">Add job to Existing Stage</a></li>
<li><a href="../configuration/admin_add_task.html">Add task to Existing Job</a></li>
<li><a href="../configuration/pipeline_templates.html">Pipeline Templates</a></li>
<li><a href="../configuration/elastic_agents.html">Elastic Agents</a></li>
<li><a href="../configuration/dev_choose_when_stage_runs.html">Choose When a Stage Runs</a></li>
<li><a href="../configuration/admin_timer.html">Timer Trigger</a></li>
<li><a href="../configuration/job_timeout.html">Job Timeout</a></li>
<li><a href="../configuration/managing_users.html">Managing Users</a></li>
<li><a href="../configuration/dev_authentication.html">Authentication</a></li>
<li><a href="../configuration/access_tokens.html">Access Tokens</a></li>
<li><a href="../configuration/dev_authorization.html">Authorizing Users</a></li>
<li><a href="../configuration/delegating_group_administration.html">Delegating Group Administration</a></li>
<li><a href="../configuration/pipeline_group_admin_config.html">Pipeline Group Administration</a></li>
<li><a href="../configuration/dev_upload_test_report.html">Publish Reports and Artifacts</a></li>
<li><a href="../configuration/managing_artifacts_and_reports.html">Managing Artifacts and Reports</a></li>
<li><a href="../configuration/delete_artifacts.html">Auto Delete Artifacts</a></li>
<li><a href="../configuration/ui_testing.html">UI Testing</a></li>
<li><a href="../configuration/admin_mailhost_info.html">Mailhost Information</a></li>
<li><a href="../configuration/dev_notifications.html">Notifications</a></li>
<li><a href="../configuration/tfs_config.html">TFS Material configuration</a></li>
<li><a href="../configuration/configuration_reference.html">Reference</a></li>
<li><a href="../configuration/schema.html">Schema</a></li>
</ul></li>

<li><p><a href="../advanced_usage/"><strong>Advanced Usage</strong></a></p>

<ul>
<li><a href="../advanced_usage/pipelines_as_code.html">Pipelines as code</a></li>
<li><a href="../advanced_usage/agent_auto_register.html">Auto Register a Remote Agent</a></li>
<li><a href="../advanced_usage/admin_spawn_multiple_jobs.html">Spawn multiple instances of a Job</a></li>
<li><a href="../advanced_usage/admin_install_multiple_agents.html">Multiple Agents on One Machine</a></li>
<li><a href="../advanced_usage/dev_clean_up_when_cancel.html">Clean on Task Cancel</a></li>
<li><a href="../advanced_usage/dev_conditional_task_execution.html">Conditional Task Execution</a></li>
<li><a href="../advanced_usage/trigger_with_options.html">Trigger With Options</a></li>
<li><a href="../advanced_usage/fan_in.html">Fan In</a></li>
<li><a href="../advanced_usage/properties.html">Properties</a></li>
<li><a href="../advanced_usage/logging.html">Logging</a></li>
<li><a href="../advanced_usage/compare_pipelines.html">Compare Builds</a></li>
<li><a href="../advanced_usage/stage_duration_chart.html">Graphs</a></li>
<li><a href="../advanced_usage/command_repository.html">Command Repository</a></li>
<li><a href="../advanced_usage/one_click_backup.html">Backup GoCD Server</a></li>
<li><a href="../advanced_usage/cron_backup.html">Timer Based GoCD Server Backup</a></li>
<li><a href="../advanced_usage/config_repo.html">Config Repository</a></li>
<li><a href="../advanced_usage/other_config_options.html">Other Config Options</a></li>
<li><a href="../advanced_usage/agent-health-check-api.html">Agent Health Check API</a></li>
<li><a href="../advanced_usage/maintenance_mode.html">Maintenance Mode</a><br /></li>
</ul></li>

<li><p><a href="../integration/"><strong>Integrating GoCD With Other Tools</strong></a></p></li>

<li><p><a href="../extension_points/"><strong>Extension Points Of GoCD</strong></a></p>

<ul>
<li><a href="../extension_points/plugin_user_guide.html">Plugin User Guide</a></li>
<li><a href="../extension_points/package_repository_extension.html">Package Repository Extension</a></li>
<li><a href="../extension_points/yum_repository_poller.html">Yum Repository Poller</a></li>
<li><a href="../extension_points/scm_extension.html">SCM Extension</a></li>
<li><a href="../extension_points/task_extension.html">Task Extension</a></li>
<li><a href="../extension_points/configrepo_extension.html">Configuration repository Extension</a></li>
</ul></li>

<li><p><a href="../gocd_on_kubernetes/"><strong>GoCD on Kubernetes</strong></a></p>

<ul>
<li><a href="../gocd_on_kubernetes/introduction.html">Introduction</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/setup_and_configuration.html">Setup and configuration</a>

<ul>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/setup.html">Setup</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/configure_cluster.html">Configure your Kubernetes Cluster</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/helm_install.html">Install the GoCD Helm chart</a></li>
</ul></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline.html">Designing a CD Pipeline</a>

<ul>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/creating_a_build_pipeline.html">Create a pipeline to build application</a></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/creating_a_test_pipeline.html">Create a pipeline to test the built application</a></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/creating_a_deploy_pipeline.html">Create a pipeline to deploy on Kubernetes</a></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/docker_workflows.html">Docker workflows</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/configure_k8s_ea_plugin.html">Configure the Kubernetes Elastic Agent plugin</a></li>
</ul></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/troubleshooting.html">Troubleshooting</a></li>
</ul></li>

<li><p><a href="../faq/"><strong>FAQ/Troubleshooting</strong></a></p>

<ul>
<li><a href="../faq/ordering_of_pipelines.html">Ordering of Pipelines</a></li>
<li><a href="../faq/stage_old_config.html">Historical Configuration</a></li>
<li><a href="../faq/concurrent_config_modifications.html">Concurrent Modifications to Config</a></li>
<li><a href="../faq/dev_understand_why_build_broken.html">Why the Build is Broken?</a></li>
<li><a href="../faq/dev_see_artifact_as_tab.html">See artifacts as sub-tabs</a></li>
<li><a href="../faq/dev_save_properties.html">Save Properties for a Build</a></li>
<li><a href="../faq/dev_use_current_revision_in_build.html">Using Environment variables</a></li>
<li><a href="../faq/rm_deploy_to_environment.html">Deploy to an environment</a></li>
<li><a href="../faq/tester_what_has_changed.html">See changes in new binary</a></li>
<li><a href="../faq/dependency_management.html">Run Tests against new Builds</a></li>
<li><a href="../faq/rm_what_is_deployed.html">Check What&rsquo;s Deployed</a></li>
<li><a href="../faq/deploy_a_specific_build_to_an_environment.html">Deploy a Specific Build</a></li>
<li><a href="../faq/agent_guid_issue.html">Clone/Copy an Existing Agents</a></li>
<li><a href="../faq/job_rerun.html">How do I re-run jobs?</a></li>
<li><a href="../faq/material_update_hung.html">Go unable to poll for changes</a></li>
<li><a href="../faq/artifact_integrity.html">Artifact integrity verification</a></li>
<li><a href="../faq/notifications_page.html">Email Notifications</a></li>
<li><a href="../faq/admin_out_of_disk_space.html">Running out of Disk Space</a></li>
<li><a href="../faq/docker_container_ssh_keys.html">Configure SSH Keys for dockerized GoCD</a></li>
</ul></li>

<li><p><a href="../beta/"><strong>Beta features</strong></a></p>

<ul>
<li><a href="../beta/comment_on_pipeline_run.html">Comment on a pipeline run</a><br /></li>
</ul></li>

<li><p><a href="../release_history/"><strong>Release History</strong></a></p>

<ul>
<li><a href="../release_history/whats_new_in_go.html">What&rsquo;s New in Go</a><br /></li>
</ul></li>
</ul>




</nav>
    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="../svg/menu.svg" />
  </label>
  <strong>Lock a Pipeline</strong>
</header>

      
<div class="has-results">
  <ul id="results"></ul>
</div>
<div class="no-results hide">
  Your query search resulted in no results.
</div>

      
<article class="markdown">

<h1 id="pipeline-locking-ensure-only-one-instance-of-a-gocd-pipeline-can-run-at-the-same-time">Pipeline locking: Ensure only one instance of a GoCD pipeline can run at the same time</h1>

<p>Sometimes you want to ensure that only a single instance of a pipeline can run at a time. This is important if the
stages of a pipeline are interrelated. For example the first stage may set up an environment that is used by the next
stage in the pipeline.</p>

<p>If a pipeline is locked then GoCD will not allow any other instance of that pipeline to be scheduled until the currently running one has been completed.</p>

<p>To enable locking from the Config UI, navigate to the Pipeline Settings section of a pipeline. There are three options for locking:</p>

<h2 id="option-1-run-single-instance-of-pipeline-at-a-time-lock-behavior-unlock-when-finished">Option 1: Run single instance of pipeline at a time (&ldquo;Lock behavior: Unlock when finished&rdquo;)</h2>

<p>This option enables a single instance of the pipeline to run at a time by temporarily locking the pipeline and
unlocking it when finished. When the pipeline finishes, either because of the failure of any stage or the success of the
final stage, the pipeline is automatically unlocked. The pipeline is also unlocked if it reaches a manual stage.</p>

<p><img src="../images/pipeline_lock_behavior_01_unlock_when_finished.png" alt="Pipeline locking behavior - Unlock when finished" /></p>

<h2 id="option-2-run-single-instance-of-pipeline-and-lock-on-failure-lock-behavior-lock-on-failure">Option 2: Run single instance of pipeline and lock on failure (&ldquo;Lock behavior: Lock on failure&rdquo;)</h2>

<p>This option enables a single instance of the pipeline to run at a time. The pipeline is locked when it starts and it
remains locked if it fails. The pipeline is unlocked if it reaches the last stage (even if it fails). The pipeline is
not unlocked if it reaches a manual stage. If a pipeline is locked, it will not allow any new instances to run, unless
it is unlocked, either manually or <a href="https://api.gocd.org/current/#releasing-a-pipeline-lock">through the API</a>.</p>

<p><img src="../images/pipeline_lock_behavior_02_lock_on_failure.png" alt="Pipeline locking behavior - Lock on failure" /></p>

<h2 id="option-3-run-multiple-instances-lock-behavior-none">Option 3: Run multiple instances (&ldquo;Lock behavior: None&rdquo;)</h2>

<p>This is the default behavior. Multiple instances of a pipeline can run simultaneously.</p>

<p><img src="../images/pipeline_lock_behavior_03_none.png" alt="Pipeline locking behavior - None" /></p>

<h1 id="controlling-locking-behavior-from-the-config-xml">Controlling locking behavior from the config XML</h1>

<p>To enable locking from the Config XML set the <code>lockBehavior</code> attribute to one of <code>unlockWhenFinished</code>, <code>lockOnFailure</code>
or <code>none</code>, corresponding to the three options shown above:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#008000;font-weight:bold">&lt;pipeline</span> <span style="color:#b44">name=</span><span style="color:#b44">&#34;my-locked-pipeline&#34;</span> <span style="color:#b44">lockBehavior=</span><span style="color:#b44">&#34;lockOnFailure&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;materials&gt;</span>
        ...
    <span style="color:#008000;font-weight:bold">&lt;/materials&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;stages&gt;</span>
        ...
    <span style="color:#008000;font-weight:bold">&lt;/stages&gt;</span>
<span style="color:#008000;font-weight:bold">&lt;/pipeline&gt;</span></code></pre></div>
<p>Also see the <a href="configuration_reference.html#pipeline">configuration reference</a>.</p>
</article>

      
<div class="align-center book-git-footer justify-end">
  
  
  <div>
    <a href="https://github.com/gocd/docs.go.cd/edit/master/content/configuration/admin_lock_pipelines.md" target="_blank" rel="noopener">
      <img src="../svg/code-fork.svg" /> Edit this page
    </a>
  </div>
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#pipeline-locking-ensure-only-one-instance-of-a-gocd-pipeline-can-run-at-the-same-time">Pipeline locking: Ensure only one instance of a GoCD pipeline can run at the same time</a>
<ul>
<li><a href="#option-1-run-single-instance-of-pipeline-at-a-time-lock-behavior-unlock-when-finished">Option 1: Run single instance of pipeline at a time (&ldquo;Lock behavior: Unlock when finished&rdquo;)</a></li>
<li><a href="#option-2-run-single-instance-of-pipeline-and-lock-on-failure-lock-behavior-lock-on-failure">Option 2: Run single instance of pipeline and lock on failure (&ldquo;Lock behavior: Lock on failure&rdquo;)</a></li>
<li><a href="#option-3-run-multiple-instances-lock-behavior-none">Option 3: Run multiple instances (&ldquo;Lock behavior: None&rdquo;)</a></li>
</ul></li>
<li><a href="#controlling-locking-behavior-from-the-config-xml">Controlling locking behavior from the config XML</a></li>
</ul>
</nav>
  </aside>



  </main>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-48357651-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
