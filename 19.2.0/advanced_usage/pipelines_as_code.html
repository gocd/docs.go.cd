<!DOCTYPE html>


<html>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pipelines as code | GoCD User Documentation</title>

<meta name="description" content="GoCD supports storing pipeline configuration in a source code repository, either with your application code or in a separate repository all on its own."/>
<meta name="keywords" content="[pipeline as code, pipeline configuration, JSON, YAML]"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="canonical" href="https://docs.gocd.org/current/advanced_usage/pipelines_as_code.html"/>
<script src="../javascripts/_gdpr-banner.js" type="text/javascript"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

<link rel="stylesheet" href="../normalize.min.css"/>
<link rel="stylesheet" href="../stylesheets/website.css"/>

<link rel="stylesheet" href="../book.min.9df8a81abb8f5ac18e5d5b9e4ddfc111a59f4a7621a51c5b28d3cc60ac52eac2.css"/>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-48357651-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  
</head>

<body>
  <input type="checkbox" style="display: none" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav role="navigation">
<a href="https://www.gocd.org"> <img src="../svg/product_ui_logo_go.svg" class="icon" /></a>


    



<script>
    (function() {
        var menu = document.querySelector('aside.book-menu nav')
        addEventListener('beforeunload', function(event) {
            localStorage.setItem('menu.scrollTop', menu.scrollTop)
        });
    })();
    function loadFunction(){
        var menu = document.querySelector('aside.book-menu nav')
        var top = parseInt(localStorage.getItem('menu.scrollTop'));
        $(menu).animate({
            scrollTop: top
        }, 10)
    }
    $(document).ready = loadFunction();
</script>


<style>
  nav ul a[href$="\2f advanced_usage\2fpipelines_as_code.html"] {
  color: #004ed0;
  }
</style>

<ul>
<li><a href="https://www.gocd.org/"><strong>Back to GoCD.org</strong></a></li>

<li><p><a href="https://github.com/gocd/docs.go.cd/"><strong>Contribute</strong></a></p>

<hr /></li>

<li><p><a href="../"><strong>Introduction</strong></a></p></li>

<li><p><a href="../introduction.html"><strong>Concepts In GoCD</strong></a></p>

<ul>
<li><a href="../introduction/concepts_in_go.html">Concepts In GoCD</a></li>
</ul></li>

<li><p><a href="../navigation.html"><strong>GoCD Tour</strong></a></p>

<ul>
<li><a href="../navigation/pipelines_dashboard_page.html">Pipeline Dashboard</a></li>
<li><a href="../navigation/agents_page.html">Agents</a></li>
<li><a href="../navigation/agent_details.html">Agent Details</a></li>
<li><a href="../navigation/pipeline_activity_page.html">Pipeline Activity</a></li>
<li><a href="../navigation/stage_details_page.html">Stage Details</a></li>
<li><a href="../navigation/job_details_page.html">Job Details</a></li>
<li><a href="../navigation/administration_page.html">Administration</a></li>
<li><a href="../navigation/server_details_page.html">Server Details</a></li>
<li><a href="../navigation/environments_page.html">Environments</a></li>
<li><a href="../navigation/value_stream_map.html">Value Stream Map</a></li>
</ul></li>

<li><p><a href="../installation.html"><strong>Installing GoCD</strong></a></p>

<ul>
<li><a href="../installation/system_requirements.html">System requirements</a></li>
<li><a href="../installation/installing_go_server.html">Installing GoCD Server</a>

<ul>
<li><a href="../installation/install/server/linux.html">Linux</a></li>
<li><a href="../installation/install/server/windows.html">Windows</a></li>
<li><a href="../installation/install/server/osx.html">Mac OS X</a></li>
<li><a href="../installation/install/server/zip.html">Generic Zip</a></li>
</ul></li>
<li><a href="../installation/installing_go_agent.html">Installing GoCD Agent</a>

<ul>
<li><a href="../installation/install/agent/linux.html">Linux</a></li>
<li><a href="../installation/install/agent/windows.html">Windows</a></li>
<li><a href="../installation/install/agent/osx.html">Mac OS X</a></li>
<li><a href="../installation/install/agent/zip.html">Generic Zip</a></li>
</ul></li>
<li><a href="../installation/upgrading_go.html">Upgrading GoCD</a></li>
<li><a href="../installation/configuring_server_details.html">Configuring Server Details</a></li>
<li><a href="../installation/configure-reverse-proxy.html">Configure a Reverse Proxy</a></li>
<li><a href="../installation/configure-agent-proxy.html">Configure an agent with proxy</a></li>
<li><a href="../installation/ssl_tls_config.html">Configuring SSL/TLS</a>

<ul>
<li><a href="../installation/ssl_tls/setting_up_ciphers.html">Customizing Ciphers</a></li>
<li><a href="../installation/ssl_tls/custom_server_certificate.html">Change SSL Certificates</a></li>
<li><a href="../installation/ssl_tls/end_to_end_transport_security.html">End to end transport security</a></li>
<li><a href="../installation/ssl_tls/configuring_hsts_header.html">Configuring HSTS Header</a></li>
</ul></li>
<li><a href="../installation/performance_tuning.html">Performance Tuning</a></li>
<li><a href="../installation/hardware_specifications.html">Hardware Specifications</a></li>
<li><a href="../installation/troubleshooting.html">Troubleshooting</a></li>
</ul></li>

<li><p><a href="../configuration.html"><strong>Configuration</strong></a></p>

<ul>
<li><a href="../configuration/quick_pipeline_setup.html">Setup a New Pipeline</a></li>
<li><a href="../configuration/managing_pipelines.html">Managing Pipelines</a></li>
<li><a href="../configuration/managing_dependencies.html">Managing Dependencies</a></li>
<li><a href="../configuration/managing_a_build_cloud.html">Managing Agents</a></li>
<li><a href="../configuration/managing_environments.html">Managing Environments</a></li>
<li><a href="../configuration/build_labelling.html">Pipeline Labelling</a></li>
<li><a href="../configuration/pipeline_scheduling.html">Pipeline Scheduling</a></li>
<li><a href="../configuration/admin_use_parameters_in_configuration.html">Parameterize a Pipeline</a></li>
<li><a href="../configuration/admin_use_custom_pipeline_label.html">Customize a Pipeline Label</a></li>
<li><a href="../configuration/admin_clone_pipeline.html">Clone a Pipeline</a></li>
<li><a href="../configuration/admin_lock_pipelines.html">Lock a Pipeline</a></li>
<li><a href="../configuration/admin_add_material.html">Add Material to Existing Pipeline</a></li>
<li><a href="../configuration/admin_add_stage.html">Add Stage to Existing Pipeline</a></li>
<li><a href="../configuration/admin_add_job.html">Add job to Existing Stage</a></li>
<li><a href="../configuration/admin_add_task.html">Add task to Existing Job</a></li>
<li><a href="../configuration/pipeline_templates.html">Pipeline Templates</a></li>
<li><a href="../configuration/elastic_agents.html">Elastic Agents</a></li>
<li><a href="../configuration/dev_choose_when_stage_runs.html">Choose When a Stage Runs</a></li>
<li><a href="../configuration/admin_timer.html">Timer Trigger</a></li>
<li><a href="../configuration/job_timeout.html">Job Timeout</a></li>
<li><a href="../configuration/managing_users.html">Managing Users</a></li>
<li><a href="../configuration/dev_authentication.html">Authentication</a></li>
<li><a href="../configuration/personal_access_token.html">Personal Access Token</a></li>
<li><a href="../configuration/dev_authorization.html">Authorizing Users</a></li>
<li><a href="../configuration/delegating_group_administration.html">Delegating Group Administration</a></li>
<li><a href="../configuration/pipeline_group_admin_config.html">Pipeline Group Administration</a></li>
<li><a href="../configuration/dev_upload_test_report.html">Publish Reports and Artifacts</a></li>
<li><a href="../configuration/managing_artifacts_and_reports.html">Managing Artifacts and Reports</a></li>
<li><a href="../configuration/delete_artifacts.html">Auto Delete Artifacts</a></li>
<li><a href="../configuration/ui_testing.html">UI Testing</a></li>
<li><a href="../configuration/admin_mailhost_info.html">Mailhost Information</a></li>
<li><a href="../configuration/dev_notifications.html">Notifications</a></li>
<li><a href="../configuration/tfs_config.html">TFS Material configuration</a></li>
<li><a href="../configuration/configuration_reference.html">Reference</a></li>
<li><a href="../configuration/schema.html">Schema</a></li>
</ul></li>

<li><p><a href="../advanced_usage.html"><strong>Advanced Usage</strong></a></p>

<ul>
<li><a href="../advanced_usage/pipelines_as_code.html">Pipelines as code</a></li>
<li><a href="../advanced_usage/agent_auto_register.html">Auto Register a Remote Agent</a></li>
<li><a href="../advanced_usage/admin_spawn_multiple_jobs.html">Spawn multiple instances of a Job</a></li>
<li><a href="../advanced_usage/admin_install_multiple_agents.html">Multiple Agents on One Machine</a></li>
<li><a href="../advanced_usage/dev_clean_up_when_cancel.html">Clean on Task Cancel</a></li>
<li><a href="../advanced_usage/dev_conditional_task_execution.html">Conditional Task Execution</a></li>
<li><a href="../advanced_usage/trigger_with_options.html">Trigger With Options</a></li>
<li><a href="../advanced_usage/fan_in.html">Fan In</a></li>
<li><a href="../advanced_usage/properties.html">Properties</a></li>
<li><a href="../advanced_usage/logging.html">Logging</a></li>
<li><a href="../advanced_usage/compare_pipelines.html">Compare Builds</a></li>
<li><a href="../advanced_usage/stage_duration_chart.html">Graphs</a></li>
<li><a href="../advanced_usage/command_repository.html">Command Repository</a></li>
<li><a href="../advanced_usage/one_click_backup.html">Backup GoCD Server</a></li>
<li><a href="../advanced_usage/cron_backup.html">Timer Based GoCD Server Backup</a></li>
<li><a href="../advanced_usage/config_repo.html">Config Repository</a></li>
<li><a href="../advanced_usage/other_config_options.html">Other Config Options</a></li>
<li><a href="../advanced_usage/agent-health-check-api.html">Agent Health Check API</a></li>
<li><a href="../advanced_usage/maintenance_mode.html">Maintenance Mode</a><br /></li>
</ul></li>

<li><p><a href="../integration.html"><strong>Integrating GoCD With Other Tools</strong></a></p></li>

<li><p><a href="../extension_points.html"><strong>Extension Points Of GoCD</strong></a></p>

<ul>
<li><a href="../extension_points/plugin_user_guide.html">Plugin User Guide</a></li>
<li><a href="../extension_points/package_repository_extension.html">Package Repository Extension</a></li>
<li><a href="../extension_points/yum_repository_poller.html">Yum Repository Poller</a></li>
<li><a href="../extension_points/scm_extension.html">SCM Extension</a></li>
<li><a href="../extension_points/task_extension.html">Task Extension</a></li>
<li><a href="../extension_points/configrepo_extension.html">Configuration repository Extension</a></li>
</ul></li>

<li><p><a href="../gocd_on_kubernetes.html"><strong>GoCD on Kubernetes</strong></a></p>

<ul>
<li><a href="../gocd_on_kubernetes/introduction.html">Introduction</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/setup_and_configuration.html">Setup and configuration</a>

<ul>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/setup.html">Setup</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/configure_cluster.html">Configure your Kubernetes Cluster</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/helm_install.html">Install the GoCD Helm chart</a></li>
</ul></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline.html">Designing a CD Pipeline</a>

<ul>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/creating_a_build_pipeline.html">Create a pipeline to build application</a></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/creating_a_test_pipeline.html">Create a pipeline to test the built application</a></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/creating_a_deploy_pipeline.html">Create a pipeline to deploy on Kubernetes</a></li>
<li><a href="../gocd_on_kubernetes/designing_a_cd_pipeline/docker_workflows.html">Docker workflows</a></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/configure_k8s_ea_plugin.html">Configure the Kubernetes Elastic Agent plugin</a></li>
</ul></li>
<li><a href="../gocd_on_kubernetes/gocd_helm_chart/troubleshooting.html">Troubleshooting</a></li>
</ul></li>

<li><p><a href="../faq.html"><strong>FAQ/Troubleshooting</strong></a></p>

<ul>
<li><a href="../faq/ordering_of_pipelines.html">Ordering of Pipelines</a></li>
<li><a href="../faq/stage_old_config.html">Historical Configuration</a></li>
<li><a href="../faq/concurrent_config_modifications.html">Concurrent Modifications to Config</a></li>
<li><a href="../faq/dev_understand_why_build_broken.html">Why the Build is Broken?</a></li>
<li><a href="../faq/dev_see_artifact_as_tab.html">See artifacts as sub-tabs</a></li>
<li><a href="../faq/dev_save_properties.html">Save Properties for a Build</a></li>
<li><a href="../faq/environment_variables.html">Using Environment variables</a></li>
<li><a href="../faq/rm_deploy_to_environment.html">Deploy to an environment</a></li>
<li><a href="../faq/tester_what_has_changed.html">See changes in new binary</a></li>
<li><a href="../faq/dependency_management.html">Run Tests against new Builds</a></li>
<li><a href="../faq/rm_what_is_deployed.html">Check What&rsquo;s Deployed</a></li>
<li><a href="../faq/deploy_a_specific_build_to_an_environment.html">Deploy a Specific Build</a></li>
<li><a href="../faq/agent_guid_issue.html">Clone/Copy an Existing Agents</a></li>
<li><a href="../faq/job_rerun.html">How do I re-run jobs?</a></li>
<li><a href="../faq/material_update_hung.html">Go unable to poll for changes</a></li>
<li><a href="../faq/artifact_integrity.html">Artifact integrity verification</a></li>
<li><a href="../faq/notifications_page.html">Email Notifications</a></li>
<li><a href="../faq/admin_out_of_disk_space.html">Running out of Disk Space</a></li>
<li><a href="../faq/docker_container_ssh_keys.html">Configure SSH Keys for dockerized GoCD</a></li>
</ul></li>

<li><p><a href="../beta.html"><strong>Beta features</strong></a></p>

<ul>
<li><a href="../beta/comment_on_pipeline_run.html">Comment on a pipeline run</a><br /></li>
</ul></li>

<li><p><a href="../release_history.html"><strong>Release History</strong></a></p>

<ul>
<li><a href="../release_history/whats_new_in_go.html">What&rsquo;s New in Go</a><br /></li>
</ul></li>
</ul>




</nav>
    </aside>

    <div class="book-page">
      <header class="align-center justify-between book-header">
  <label for="menu-control">
    <img src="../svg/menu.svg" />
  </label>
  <strong>Pipelines as code</strong>
</header>

      
<article class="markdown">

<h1 id="pipelines-as-code">Pipelines as code</h1>

<p>GoCD supports storing pipeline configuration in a source code repository, either with your application code or in a
separate repository all on its own. It allows you to move it out of GoCD so that you can modify, control and version it
externally. Such modifications will be seen by a periodic poller in the GoCD server and it will merge those pipeline
configurations into the pipelines it finds in the main configuration XML file. You can see a quick preview video of this
feature <a href="https://www.youtube.com/watch?v=1AfBxCWRqD8&amp;feature=youtu.be">here</a>.</p>

<p>It is important to note that not all pipelines need to be external to the config (any existing config, in any existing
GoCD server will be valid). It is also important to note that this feature includes the ability for GoCD to monitor and
merge external pipelines defined in multiple &ldquo;config repositories&rdquo;. It is also possible for a pipeline defined in a
config repository to be dependent on a pipeline defined in the main config XML of the GoCD server.</p>

<p>This ability is exposed as a plugin endpoint and so, anyone can write a plugin for a config repository, to store the configuration in any manner you choose.</p>

<p>Here&rsquo;s an image which shows the relationship between the different pieces of a setup such as this:</p>

<p><img src="../images/advanced_usage/pipelines_as_code.png" alt="Pipelines as code" /></p>

<p>A quick note about &ldquo;Infrastructure as code&rdquo;: Many people seem to associate only being able to check in configuration to
a repository as a part of &ldquo;Infrastructure as code&rdquo;. However, the ability to configure the GoCD server through code has
existed in various forms. For instance, <a href="https://github.com/SpringerSBM/gomatic">gomatic</a>, using
<a href="https://api.gocd.org/current/">GoCD APIs</a>, <a href="https://github.com/grundic/yagocd">yagocd</a>,
<a href="https://github.com/gaqzi/py-gocd">gocd-cli</a>, etc. This is another way of doing the same. In this case, it&rsquo;s possible to
make it more declarative, depending on the plugin and possibly give more control to others.</p>

<h2 id="currently-available-plugins-for-storing-pipelines-as-code">Currently available plugins for storing pipelines as code</h2>

<p>Pipelines can currently be stored using JSON or YAML.</p>

<h3 id="storing-pipeline-configuration-in-json">Storing pipeline configuration in JSON</h3>

<p>The setup needed to allow this is:</p>

<ol>
<li><p>After starting the server, open the config XML (&ldquo;Admin -&gt; Config XML&rdquo;) and add a config repository for the server to poll. This tag should be added just after the &ldquo;<code>&lt;server&gt;</code>&rdquo; tag, at the top level, as a child of &ldquo;<code>&lt;cruise&gt;</code>&ldquo;:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">  <span style="color:#008000;font-weight:bold">&lt;config-repos&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;config-repo</span> <span style="color:#b44">pluginId=</span><span style="color:#b44">&#34;json.config.plugin&#34;</span> <span style="color:#b44">id=</span><span style="color:#b44">&#34;gocd-demo-config-repo-json&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
      <span style="color:#008000;font-weight:bold">&lt;git</span> <span style="color:#b44">url=</span><span style="color:#b44">&#34;https://github.com/arvindsv/gocd-demo-config-repo-json.git&#34;</span> <span style="color:#008000;font-weight:bold">/&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;/config-repo&gt;</span>
  <span style="color:#008000;font-weight:bold">&lt;/config-repos&gt;</span></code></pre></div>
<p>You can fork the repository mentioned above to your own GitHub account or locally, so that you can make some changes
to see what happens. Any file ending in &ldquo;.gopipeline.json&rdquo; is picked up by the plugin. Documentation of what is
possible in the JSON is <a href="https://github.com/tomzo/gocd-json-config-plugin">here</a>.</p></li>

<li><p>Give it a minute or so for the polling to happen. Once that happens, you should see three new pipelines on your
dashboard, as a part of the &ldquo;demo&rdquo; pipeline group. You can make some changes to the JSON (change a group, add a
stage, etc), and upon the next poll, the server will see those changes and apply them to the pipeline
config. Remember that, if you make any changes and make a mistake, you&rsquo;ll see an error at the bottom right corner (a
red box).</p></li>

<li><p>You can even have multiple repositories. Just repeat the <code>&lt;config-repo&gt;</code> tag and make sure that there are no duplicate pipelines.</p></li>
</ol>

<h3 id="storing-pipeline-configuration-in-yaml">Storing pipeline configuration in YAML</h3>

<p>Tomasz <a href="https://groups.google.com/forum/#!topic/go-cd/bAFYdWOQLEs/discussion">announced</a> a Yaml plugin. The setup needed to allow this is:</p>

<ol>
<li><p>After starting the server, open the config XML (&ldquo;Admin -&gt; Config XML&rdquo;) and add a config repository for the server to poll. This tag should be added just after the &ldquo;<code>&lt;server&gt;</code>&rdquo; tag, at the top level, as a child of &ldquo;<code>&lt;cruise&gt;</code>&ldquo;:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">  <span style="color:#008000;font-weight:bold">&lt;config-repos&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;config-repo</span> <span style="color:#b44">pluginId=</span><span style="color:#b44">&#34;yaml.config.plugin&#34;</span> <span style="color:#b44">id=</span><span style="color:#b44">&#34;gocd-yaml-config-example&#34;</span><span style="color:#008000;font-weight:bold">&gt;</span>
      <span style="color:#008000;font-weight:bold">&lt;git</span> <span style="color:#b44">url=</span><span style="color:#b44">&#34;https://github.com/tomzo/gocd-yaml-config-example.git&#34;</span> <span style="color:#008000;font-weight:bold">/&gt;</span>
    <span style="color:#008000;font-weight:bold">&lt;/config-repo&gt;</span>
  <span style="color:#008000;font-weight:bold">&lt;/config-repos&gt;</span></code></pre></div>
<p>You can fork the repository mentioned above to your own GitHub account or locally, so that you can make some changes
to see what happens. Any file ending in &ldquo;.gocd.yaml&rdquo; is picked up by the plugin. Documentation of what is
possible in the YAML file is <a href="https://github.com/tomzo/gocd-yaml-config-plugin">here</a>.</p></li>

<li><p>Give it a minute or so for the polling to happen. Once that happens, you should see three new pipelines on your
dashboard, as a part of the &ldquo;demo&rdquo; pipeline group. You can make some changes to the YAML (change a group, add a
stage, etc), and upon the next poll, the server will see those changes and apply them to the pipeline
config. Remember that, if you make any changes and make a mistake, you&rsquo;ll see an error at the bottom right corner (a
red box).</p></li>

<li><p>You can even have multiple repositories. Just repeat the <code>&lt;config-repo&gt;</code> tag and make sure that there are no duplicate pipelines.</p></li>
</ol>
</article>

      
<div class="align-center book-git-footer justify-end">
  
  
  <div>
    <a href="https://github.com/gocd/docs.go.cd/edit/master/content/advanced_usage/pipelines_as_code.md" target="_blank" rel="noopener">
      <img src="../svg/code-fork.svg" /> Edit this page
    </a>
  </div>
  
</div>


    </div>

    
  
  
  <aside class="book-toc fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#pipelines-as-code">Pipelines as code</a>
<ul>
<li><a href="#currently-available-plugins-for-storing-pipelines-as-code">Currently available plugins for storing pipelines as code</a>
<ul>
<li><a href="#storing-pipeline-configuration-in-json">Storing pipeline configuration in JSON</a></li>
<li><a href="#storing-pipeline-configuration-in-yaml">Storing pipeline configuration in YAML</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-48357651-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
